<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>ReportManager - Valmet QCS</title>
  <link rel="manifest" href="manifest.json">
  <link rel="stylesheet" href="assets/css/styles.css">
</head>
<body>
  <header>
    <h1>ğŸ“‹ ReportManager</h1>
    <p class="subtitle">Informes QCS</p>
  </header>

  <!-- Tab Navigation -->
  <nav class="tab-navigation">
    <button class="tab-btn active" data-tab="datos">
      <span class="tab-icon">ğŸ“‹</span>
      <span class="tab-label">Datos</span>
    </button>
    <button class="tab-btn" data-tab="verificacion">
      <span class="tab-icon">âš™ï¸</span>
      <span class="tab-label">VerificaciÃ³n</span>
    </button>
    <button class="tab-btn" data-tab="observaciones">
      <span class="tab-icon">ğŸ“</span>
      <span class="tab-label">Observ.</span>
    </button>
    <button class="tab-btn" data-tab="firmas">
      <span class="tab-icon">âœï¸</span>
      <span class="tab-label">Firmas</span>
    </button>
  </nav>

  <main>
    <!-- Tab Content: Datos Generales -->
    <div class="tab-content active" id="tab-datos">
      <section class="card">
        <h2>ğŸ“‹ Datos Generales</h2>
      
      <div class="form-row">
        <div class="form-field">
          <label for="aÃ±o">AÃ±o</label>
          <input type="number" id="aÃ±o" placeholder="2025">
        </div>
        <div class="form-field">
          <label for="semana">Semana</label>
          <input type="number" id="semana" placeholder="1-52">
        </div>
      </div>

      <div class="form-row">
        <div class="form-field">
          <label for="cliente">Cliente</label>
          <input type="text" id="cliente" placeholder="Nombre del cliente">
        </div>
        <div class="form-field">
          <label for="albaran">AlbarÃ¡n</label>
          <input type="text" id="albaran" placeholder="NÃºmero de albarÃ¡n">
        </div>
      </div>

      <div class="form-field">
        <label for="cod-ingeniero">CÃ³digo Ingeniero</label>
        <input type="text" id="cod-ingeniero" placeholder="CÃ³digo">
      </div>

      <div class="form-field">
        <label for="ubicacion">UbicaciÃ³n del escÃ¡ner</label>
        <textarea id="ubicacion" rows="2" placeholder="UbicaciÃ³n..."></textarea>
      </div>

      <div class="form-field">
        <label for="perfiles">Perfiles en el aire</label>
        <textarea id="perfiles" rows="3" placeholder="Perfiles..."></textarea>
      </div>

      <div class="form-field">
        <label for="peticiones">Peticiones del cliente</label>
        <textarea id="peticiones" rows="3" placeholder="Peticiones..."></textarea>
      </div>
    </section>
    </div>

    <!-- Tab Content: VerificaciÃ³n -->
    <div class="tab-content" id="tab-verificacion">
      <section class="card">
        <h2>âš™ï¸ VerificaciÃ³n de Sistemas</h2>
        <p class="subtitle">Seleccione los estados de cada elemento</p>
        <div id="sections-container"></div>
      </section>
    </div>

    <!-- Tab Content: Observaciones -->
    <div class="tab-content" id="tab-observaciones">
      <section class="card">
        <h2>ğŸ“ Observaciones</h2>
        <textarea id="observaciones" rows="5" placeholder="Observaciones adicionales..."></textarea>
      </section>
    </div>

    <!-- Tab Content: Firmas -->
    <div class="tab-content" id="tab-firmas">
      <section class="card">
        <h2>âœï¸ Firmas Digitales</h2>
        
        <!-- Firma Ingeniero -->
        <div class="signature-section">
          <h3>Ingeniero Valmet</h3>
          <div class="form-field">
            <label for="nombre-ingeniero">Nombre completo</label>
            <input type="text" id="nombre-ingeniero" placeholder="Nombre del ingeniero">
          </div>
          <div class="signature-pad-container">
            <canvas id="signature-ingeniero" class="signature-canvas"></canvas>
            <div class="signature-actions">
              <button type="button" class="btn btn-secondary btn-small" id="clear-signature-ingeniero">
                ğŸ—‘ï¸ Borrar
              </button>
            </div>
          </div>
        </div>

        <!-- Firma Cliente -->
        <div class="signature-section">
          <h3>Cliente</h3>
          <div class="form-field">
            <label for="nombre-cliente-firma">Nombre completo</label>
            <input type="text" id="nombre-cliente-firma" placeholder="Nombre del cliente">
          </div>
          <div class="signature-pad-container">
            <canvas id="signature-cliente" class="signature-canvas"></canvas>
            <div class="signature-actions">
              <button type="button" class="btn btn-secondary btn-small" id="clear-signature-cliente">
                ğŸ—‘ï¸ Borrar
              </button>
            </div>
          </div>
        </div>
      </section>
    </div>

    <!-- Floating Action Button -->
    <button type="button" id="fab-generate" class="fab" title="Generar Informe">
      <span class="fab-icon">ğŸ“„</span>
    </button>

    <!-- Bottom Action Bar -->
    <div class="bottom-action-bar">
      <button type="button" id="save-draft" class="btn-action">
        ğŸ’¾ Guardar
      </button>
      <button type="button" id="load-draft" class="btn-action">
        ğŸ“‚ Cargar
      </button>
      <button type="button" id="check-storage" class="btn-action">
        ğŸ’½ Espacio
      </button>
      <button type="button" id="clear-all" class="btn-action btn-danger-outline">
        ğŸ—‘ï¸ Limpiar
      </button>
    </div>

    <!-- Status -->
    <div id="status" role="status" aria-live="polite"></div>
  </main>

  <!-- Modal para aÃ±adir fotos -->
  <div id="photo-modal" class="modal hidden" role="dialog" aria-hidden="true">
    <div class="modal-content">
      <div class="modal-header">
        <h3>ğŸ“¸ AÃ±adir Fotos</h3>
        <button type="button" class="modal-close" aria-label="Cerrar">&times;</button>
      </div>
      <div class="modal-body">
        <video id="camera-preview" autoplay playsinline class="hidden"></video>
        <canvas id="camera-snapshot" class="hidden"></canvas>
        
        <div class="photo-options">
          <button type="button" id="open-camera" class="btn btn-primary">
            ğŸ“· Usar CÃ¡mara
          </button>
          <button type="button" id="take-photo" class="btn btn-success hidden">
            âœ“ Capturar
          </button>
          <button type="button" id="close-camera" class="btn btn-secondary hidden">
            âœ• Cerrar CÃ¡mara
          </button>
          <label for="file-input" class="btn btn-secondary">
            ğŸ“ Elegir Archivo
          </label>
          <input type="file" id="file-input" accept="image/*" class="hidden">
        </div>

        <div id="selected-photos" class="photo-grid"></div>
      </div>
      <div class="modal-footer">
        <button type="button" id="confirm-photos" class="btn btn-primary">
          âœ“ Confirmar Fotos
        </button>
      </div>
    </div>
  </div>

  <!-- Modal para cargar borradores -->
  <div id="draft-modal" class="modal hidden" role="dialog" aria-hidden="true">
    <div class="modal-content">
      <div class="modal-header">
        <h3>ğŸ“‚ Borradores Guardados</h3>
        <button type="button" class="modal-close" aria-label="Cerrar">&times;</button>
      </div>
      <div class="modal-body">
        <div id="draft-list"></div>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/docx@7.8.2/build/index.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/file-saver@2.0.5/dist/FileSaver.min.js"></script>
  <script type="module" src="assets/js/constants.js"></script>
  <script type="module" src="assets/js/state-selector.js"></script>
  <script type="module" src="assets/js/database.js"></script>
  <script type="module" src="assets/js/camera.js"></script>
  <script type="module" src="assets/js/forms.js"></script>
  <script type="module" src="assets/js/reports.js"></script>
  <script type="module" src="assets/js/app.js"></script>
</body>
</html>
